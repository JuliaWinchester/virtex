// virtex v0.3.6 https://github.com/edsilv/virtex#readme
!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.virtex=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(global){var Virtex;!function(Virtex){var StringValue=function(){function StringValue(value){this.value="",value&&(this.value=value.toLowerCase())}return StringValue.prototype.toString=function(){return this.value},StringValue}();Virtex.StringValue=StringValue}(Virtex||(Virtex={}));var Virtex,__extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();!function(Virtex){var FileType=function(_super){function FileType(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(FileType,_super),FileType.DRACO=new FileType("application/draco"),FileType.CORTO=new FileType("application/corto"),FileType.GLTF=new FileType("model/gltf+json"),FileType.OBJ=new FileType("text/plain"),FileType.PLY=new FileType("application/ply"),FileType.THREEJS=new FileType("application/vnd.threejs+json"),FileType}(Virtex.StringValue);Virtex.FileType=FileType}(Virtex||(Virtex={}));var Virtex;!function(Virtex){var CORTOFileTypeHandler=function(){function CORTOFileTypeHandler(){}return CORTOFileTypeHandler.setup=function(viewport,obj,cb){var bufferGeometry=obj.geometry;bufferGeometry.computeBoundingBox();var sizeX=bufferGeometry.boundingBox.max.x-bufferGeometry.boundingBox.min.x,sizeY=bufferGeometry.boundingBox.max.y-bufferGeometry.boundingBox.min.y,sizeZ=bufferGeometry.boundingBox.max.z-bufferGeometry.boundingBox.min.z,diagonalSize=Math.sqrt(sizeX*sizeX+sizeY*sizeY+sizeZ*sizeZ),scale=1/diagonalSize,midX=(bufferGeometry.boundingBox.min.x+bufferGeometry.boundingBox.max.x)/2,midY=(bufferGeometry.boundingBox.min.y+bufferGeometry.boundingBox.max.y)/2,midZ=(bufferGeometry.boundingBox.min.z+bufferGeometry.boundingBox.max.z)/2;obj.scale.multiplyScalar(scale),obj.position.x=-midX*scale,obj.position.y=-midY*scale,obj.position.z=-midZ*scale,obj.castShadow=!0,obj.receiveShadow=!0,viewport.objectGroup.add(obj),viewport.createCamera(),cb(obj)},CORTOFileTypeHandler}();Virtex.CORTOFileTypeHandler=CORTOFileTypeHandler}(Virtex||(Virtex={}));var Virtex;!function(Virtex){var DRACOFileTypeHandler=function(){function DRACOFileTypeHandler(){}return DRACOFileTypeHandler.setup=function(viewport,obj,cb){var geometry,bufferGeometry=obj,material=new THREE.MeshStandardMaterial({vertexColors:THREE.VertexColors});null==bufferGeometry.index?geometry=new THREE.Points(bufferGeometry,material):(bufferGeometry.computeVertexNormals(),geometry=new THREE.Mesh(bufferGeometry,material)),bufferGeometry.computeBoundingBox();var sizeX=bufferGeometry.boundingBox.max.x-bufferGeometry.boundingBox.min.x,sizeY=bufferGeometry.boundingBox.max.y-bufferGeometry.boundingBox.min.y,sizeZ=bufferGeometry.boundingBox.max.z-bufferGeometry.boundingBox.min.z,diagonalSize=Math.sqrt(sizeX*sizeX+sizeY*sizeY+sizeZ*sizeZ),scale=1/diagonalSize,midX=(bufferGeometry.boundingBox.min.x+bufferGeometry.boundingBox.max.x)/2,midY=(bufferGeometry.boundingBox.min.y+bufferGeometry.boundingBox.max.y)/2,midZ=(bufferGeometry.boundingBox.min.z+bufferGeometry.boundingBox.max.z)/2;geometry.scale.multiplyScalar(scale),geometry.position.x=-midX*scale,geometry.position.y=-midY*scale,geometry.position.z=-midZ*scale,geometry.castShadow=!0,geometry.receiveShadow=!0,obj=geometry,viewport.objectGroup.add(obj),viewport.createCamera(),cb(obj)},DRACOFileTypeHandler}();Virtex.DRACOFileTypeHandler=DRACOFileTypeHandler}(Virtex||(Virtex={}));var Virtex;!function(Virtex){var glTFFileTypeHandler=function(){function glTFFileTypeHandler(){}return glTFFileTypeHandler.setup=function(viewport,obj,cb){if(viewport.objectGroup.add(obj.scene),obj.animations)for(var animations=obj.animations,i=0,l=animations.length;i<l;i++);viewport.scene=obj.scene,obj.cameras&&obj.cameras.length&&(viewport.camera=obj.cameras[0]),cb(obj)},glTFFileTypeHandler}();Virtex.glTFFileTypeHandler=glTFFileTypeHandler}(Virtex||(Virtex={}));var Virtex;!function(Virtex){var ObjFileTypeHandler=function(){function ObjFileTypeHandler(){}return ObjFileTypeHandler.setup=function(viewport,objpath,obj,cb){var imgloader=new THREE.MTLLoader;imgloader.setCrossOrigin(!0),imgloader.setPath(objpath.substring(0,objpath.lastIndexOf("/")+1)),imgloader.load(obj.materialLibraries[0],function(materials){var objLoader=new THREE.OBJLoader;objLoader.setMaterials(materials),objLoader.load(objpath,function(obj){var bufferGeometry=obj.children[0].geometry;bufferGeometry.computeBoundingBox();var sizeX=bufferGeometry.boundingBox.max.x-bufferGeometry.boundingBox.min.x,sizeY=bufferGeometry.boundingBox.max.y-bufferGeometry.boundingBox.min.y,sizeZ=bufferGeometry.boundingBox.max.z-bufferGeometry.boundingBox.min.z,diagonalSize=Math.sqrt(sizeX*sizeX+sizeY*sizeY+sizeZ*sizeZ),scale=1/diagonalSize,midX=(bufferGeometry.boundingBox.min.x+bufferGeometry.boundingBox.max.x)/2,midY=(bufferGeometry.boundingBox.min.y+bufferGeometry.boundingBox.max.y)/2,midZ=(bufferGeometry.boundingBox.min.z+bufferGeometry.boundingBox.max.z)/2;obj.scale.multiplyScalar(scale),obj.position.x=-midX*scale,obj.position.y=-midY*scale,obj.position.z=-midZ*scale,obj.castShadow=!0,obj.receiveShadow=!0,viewport.objectGroup.add(obj),viewport.createCamera(),cb(obj)},function(){},function(){})},function(){},function(){})},ObjFileTypeHandler}();Virtex.ObjFileTypeHandler=ObjFileTypeHandler}(Virtex||(Virtex={}));var Virtex;!function(Virtex){var PLYFileTypeHandler=function(){function PLYFileTypeHandler(){}return PLYFileTypeHandler.setup=function(viewport,geometry,cb){var material=new THREE.PointsMaterial({vertexColors:THREE.VertexColors}),mesh=new THREE.Points(geometry,material);viewport.objectGroup.add(mesh),viewport.createCamera(),cb(mesh)},PLYFileTypeHandler}();Virtex.PLYFileTypeHandler=PLYFileTypeHandler}(Virtex||(Virtex={}));var Virtex;!function(Virtex){var ThreeJSFileTypeHandler=function(){function ThreeJSFileTypeHandler(){}return ThreeJSFileTypeHandler.setup=function(viewport,obj,cb){viewport.objectGroup.add(obj),viewport.createCamera(),cb(obj)},ThreeJSFileTypeHandler}();Virtex.ThreeJSFileTypeHandler=ThreeJSFileTypeHandler}(Virtex||(Virtex={}));var Virtex;!function(Virtex){var Viewport=function(){function Viewport(options){this._raycastObjectCache=null,this._viewportCenter=new THREE.Vector2,this._isFullscreen=!1,this._isMouseDown=!1,this._isVRMode=!0,this._isMouseOver=!1,this._mousePos=new THREE.Vector2,this._mousePosNorm=new THREE.Vector2((-1),(-1)),this._mousePosOnMouseDown=new THREE.Vector2,this._pinchStart=new THREE.Vector2,this._targetRotationOnMouseDown=new THREE.Vector2,this._targetRotation=new THREE.Vector2,this.options=options,this.options.data=Object.assign({},this.data(),options.data),this._init(),this._resize()}return Viewport.prototype._init=function(){return this._element=this.options.target,this._element?(this._element.innerHTML="",Detector.webgl?(this._viewport=document.createElement("div"),this._viewport.classList.add("viewport"),this._loading=document.createElement("div"),this._loading.classList.add("loading"),this._loadingBar=document.createElement("div"),this._loadingBar.classList.add("bar"),this._element.appendChild(this._viewport),this._clock=new THREE.Clock,this._raycaster=new THREE.Raycaster,this.scene=new THREE.Scene,this.scene.background=new THREE.Color(this.options.data.backgroundColor),this.objectGroup=new THREE.Object3D,this.scene.add(this.objectGroup),this._createLights(),this.createCamera(),this._createRenderer(),this._createEventListeners(),this._animate(),this._viewport.appendChild(this._loading),this._loading.appendChild(this._loadingBar),this._loading.classList.add("beforeload"),this._loadObject(this.options.data.file),void(this.options.data.showStats&&(this._stats=new Stats,this._stats.domElement.style.position="absolute",this._stats.domElement.style.top="0px",this._viewport.appendChild(this._stats.domElement)))):(Detector.addGetWebGLMessage(),this._oldie=document.querySelector("#oldie"),void this._element.appendChild(this._oldie))):void console.warn("target not found")},Viewport.prototype.data=function(){return{alpha:!0,ambientLightColor:13684944,ambientLightIntensity:1,antialias:!0,cameraZ:4.5,directionalLight1Color:16777215,directionalLight1Intensity:.75,directionalLight2Color:10584,directionalLight2Intensity:.5,doubleSided:!0,fadeSpeed:1750,far:1e4,file:"",fullscreenEnabled:!0,maxZoom:10,minZoom:2,near:.05,shading:THREE.SmoothShading,showStats:!1,type:Virtex.FileType.OBJ,backgroundColor:0,vrEnabled:!0,zoomSpeed:1}},Viewport.prototype._animate=function(){this._renderer.animate(this._render.bind(this))},Viewport.prototype._onPointerRestricted=function(){var pointerLockElement=this._renderer.domElement;pointerLockElement&&"function"==typeof pointerLockElement.requestPointerLock&&pointerLockElement.requestPointerLock()},Viewport.prototype._onPointerUnrestricted=function(){var currentPointerLockElement=document.pointerLockElement,expectedPointerLockElement=this._renderer.domElement;currentPointerLockElement&&currentPointerLockElement===expectedPointerLockElement&&"function"==typeof document.exitPointerLock&&document.exitPointerLock()},Viewport.prototype._createLights=function(){this._lightGroup=new THREE.Object3D,this.scene.add(this._lightGroup);var light1=new THREE.DirectionalLight(this.options.data.directionalLight1Color,this.options.data.directionalLight1Intensity);light1.position.set(1,1,1),this._lightGroup.add(light1);var light2=new THREE.DirectionalLight(this.options.data.directionalLight2Color,this.options.data.directionalLight2Intensity);light2.position.set(-1,-1,-1),this._lightGroup.add(light2);var ambientLight=new THREE.AmbientLight(this.options.data.ambientLightColor,this.options.data.ambientLightIntensity);this._lightGroup.add(ambientLight)},Viewport.prototype.createCamera=function(){if(this.camera&&this.scene.remove(this.camera),this.camera=new THREE.PerspectiveCamera(this._getFov(),this._getAspectRatio(),this.options.data.near,this.options.data.far),!this._isVRMode){var cameraZ=this._getCameraZ();this.camera.position.z=this._targetZoom=cameraZ}this.scene.add(this.camera)},Viewport.prototype._createRenderer=function(){this._viewport.innerHTML="",this._renderer=new THREE.WebGLRenderer({antialias:this.options.data.antialias,alpha:this.options.data.alpha}),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(this._viewport.offsetWidth,this._viewport.offsetHeight),this._isVRMode&&(this._renderer.vr.enabled=!0,window.addEventListener("vrdisplaypointerrestricted",this._onPointerRestricted.bind(this),!1),window.addEventListener("vrdisplaypointerunrestricted",this._onPointerUnrestricted.bind(this),!1),document.body.appendChild(WEBVR.createButton(this._renderer))),this._viewport.appendChild(this._renderer.domElement)},Viewport.prototype._createEventListeners=function(){var _this=this;this.options.data.fullscreenEnabled&&(document.addEventListener("webkitfullscreenchange",function(){_this._fullscreenChanged()}),document.addEventListener("mozfullscreenchange",function(){_this._fullscreenChanged()}),document.addEventListener("fullscreenchange",function(){_this._fullscreenChanged()})),this._element.addEventListener("mousedown",function(e){_this._onMouseDown(e)}),this._element.addEventListener("mousemove",function(e){_this._onMouseMove(e)}),this._element.addEventListener("mouseup",function(){_this._onMouseUp()}),this._element.addEventListener("mouseout",function(){_this._onMouseOut()}),this._element.addEventListener("mousewheel",function(e){_this._onMouseWheel(e)}),this._element.addEventListener("DOMMouseScroll",function(e){_this._onMouseWheel(e)}),this._element.addEventListener("touchstart",function(e){_this._onTouchStart(e)}),this._element.addEventListener("touchmove",function(e){_this._onTouchMove(e)}),this._element.addEventListener("touchend",function(){_this._onTouchEnd()}),window.addEventListener("resize",function(){return _this._resize()},!1)},Viewport.prototype._loadObject=function(objectPath){var _this=this;this._loading.classList.remove("beforeload"),this._loading.classList.add("duringload");var loader;switch(this.options.data.type.toString()){case Virtex.FileType.DRACO.toString():loader=new THREE.DRACOLoader;break;case Virtex.FileType.CORTO.toString():loader=new THREE.CORTOLoader;break;case Virtex.FileType.GLTF.toString():loader=new THREE.GLTFLoader;break;case Virtex.FileType.OBJ.toString():loader=new THREE.OBJLoader;break;case Virtex.FileType.THREEJS.toString():loader=new THREE.ObjectLoader;break;case Virtex.FileType.PLY.toString():loader=new THREE.PLYLoader}loader.setCrossOrigin&&loader.setCrossOrigin("anonymous"),loader.load(objectPath,function(obj){switch(_this.options.data.type.toString()){case Virtex.FileType.DRACO.toString():Virtex.DRACOFileTypeHandler.setup(_this,obj,_this._loaded.bind(_this));break;case Virtex.FileType.CORTO.toString():Virtex.CORTOFileTypeHandler.setup(_this,obj,_this._loaded.bind(_this));break;case Virtex.FileType.GLTF.toString():Virtex.glTFFileTypeHandler.setup(_this,obj,_this._loaded.bind(_this));break;case Virtex.FileType.THREEJS.toString():Virtex.ThreeJSFileTypeHandler.setup(_this,obj,_this._loaded.bind(_this));break;case Virtex.FileType.OBJ.toString():Virtex.ObjFileTypeHandler.setup(_this,objectPath,obj,_this._loaded.bind(_this));break;case Virtex.FileType.PLY.toString():Virtex.PLYFileTypeHandler.setup(_this,obj,_this._loaded.bind(_this))}},function(e){e.lengthComputable&&_this._loadProgress(e.loaded/e.total)},function(e){console.error(e)})},Viewport.prototype._loaded=function(obj){this._loading.classList.remove("duringload"),this._loading.classList.add("afterload"),this.fire(Events.LOADED,obj)},Viewport.prototype._getBoundingBox=function(){return(new THREE.Box3).setFromObject(this.objectGroup)},Viewport.prototype._getBoundingWidth=function(){return this._getBoundingBox().getSize().x},Viewport.prototype._getBoundingHeight=function(){return this._getBoundingBox().getSize().y},Viewport.prototype._getCameraZ=function(){return this._getBoundingWidth()*this.options.data.cameraZ},Viewport.prototype._getFov=function(){if(this._isVRMode)return 70;var width=this._getBoundingWidth(),height=this._getBoundingHeight(),dist=this._getCameraZ()-width,fov=2*Math.atan(height/(2*dist))*(180/Math.PI);return fov},Viewport.prototype._loadProgress=function(progress){var fullWidth=this._loading.offsetWidth,width=Math.floor(fullWidth*progress);this._loadingBar.style.width=String(width)+"px"},Viewport.prototype._fullscreenChanged=function(){this._isFullscreen?(this.exitFullscreen(),this._element.style.width=this._lastWidth,this._element.style.height=this._lastHeight):(this._lastWidth=this._getWidth()+"px",this._lastHeight=this._getHeight()+"px"),this._isFullscreen=!this._isFullscreen,this._resize()},Viewport.prototype._onMouseDown=function(event){event.preventDefault(),this._isMouseDown=!0,this._mousePosOnMouseDown.x=event.clientX-this._viewportCenter.x,this._targetRotationOnMouseDown.x=this._targetRotation.x,this._mousePosOnMouseDown.y=event.clientY-this._viewportCenter.y,this._targetRotationOnMouseDown.y=this._targetRotation.y},Viewport.prototype._onMouseMove=function(event){this._mousePos.x=event.clientX-this._viewportCenter.x,this._mousePos.y=event.clientY-this._viewportCenter.y,this._mousePosNorm.x=event.clientX/this._getWidth()*2-1,this._mousePosNorm.y=2*-(event.clientY/this._getHeight())+1,this._isMouseDown&&(this._targetRotation.y=this._targetRotationOnMouseDown.y+.02*(this._mousePos.y-this._mousePosOnMouseDown.y),this._targetRotation.x=this._targetRotationOnMouseDown.x+.02*(this._mousePos.x-this._mousePosOnMouseDown.x))},Viewport.prototype._onMouseUp=function(){this._isMouseDown=!1},Viewport.prototype._onMouseOut=function(){this._isMouseDown=!1},Viewport.prototype._onMouseWheel=function(event){event.preventDefault(),event.stopPropagation();var delta=0;void 0!==event.wheelDelta?delta=event.wheelDelta:void 0!==event.detail&&(delta=-event.detail),delta>0?this.zoomIn():delta<0&&this.zoomOut()},Viewport.prototype._onTouchStart=function(event){var touches=event.touches;1===touches.length&&(this._isMouseDown=!0,event.preventDefault(),this._mousePosOnMouseDown.x=touches[0].pageX-this._viewportCenter.x,this._targetRotationOnMouseDown.x=this._targetRotation.x,this._mousePosOnMouseDown.y=touches[0].pageY-this._viewportCenter.y,this._targetRotationOnMouseDown.y=this._targetRotation.y)},Viewport.prototype._onTouchMove=function(event){event.preventDefault(),event.stopPropagation();var touches=event.touches;switch(touches.length){case 1:event.preventDefault(),this._mousePos.x=touches[0].pageX-this._viewportCenter.x,this._targetRotation.x=this._targetRotationOnMouseDown.x+.05*(this._mousePos.x-this._mousePosOnMouseDown.x),this._mousePos.y=touches[0].pageY-this._viewportCenter.y,this._targetRotation.y=this._targetRotationOnMouseDown.y+.05*(this._mousePos.y-this._mousePosOnMouseDown.y);break;case 2:var dx=touches[0].pageX-touches[1].pageX,dy=touches[0].pageY-touches[1].pageY,distance=Math.sqrt(dx*dx+dy*dy),pinchEnd=new THREE.Vector2(0,distance),pinchDelta=new THREE.Vector2;pinchDelta.subVectors(pinchEnd,this._pinchStart),pinchDelta.y>0?this.zoomIn():pinchDelta.y<0&&this.zoomOut(),this._pinchStart.copy(pinchEnd);break;case 3:}},Viewport.prototype._onTouchEnd=function(){this._isMouseDown=!1},Viewport.prototype.rotateY=function(radians){var rotation=this.objectGroup.rotation.y+radians;this.objectGroup.rotation.y=rotation},Viewport.prototype._render=function(){if(!this._isVRMode){this.rotateY(.1*(this._targetRotation.x-this.objectGroup.rotation.y));var finalRotationY=this._targetRotation.y-this.objectGroup.rotation.x;this.objectGroup.rotation.x<=1&&this.objectGroup.rotation.x>=-1&&(this.objectGroup.rotation.x+=.1*finalRotationY),this.objectGroup.rotation.x>1?this.objectGroup.rotation.x=1:this.objectGroup.rotation.x<-1&&(this.objectGroup.rotation.x=-1);var zoomDelta=.1*(this._targetZoom-this.camera.position.z);if(this.camera.position.z+=zoomDelta,this.objectGroup.children.length){this._raycaster.setFromCamera(this._mousePosNorm,this.camera);var obj=this._getRaycastObject();if(obj){var intersects=this._raycaster.intersectObject(obj);intersects.length>0?this._isMouseOver=!0:this._isMouseOver=!1}}}this._isMouseOver?(this._element.classList.add("grabbable"),this._isMouseDown?this._element.classList.add("grabbing"):this._element.classList.remove("grabbing")):(this._element.classList.remove("grabbable"),this._element.classList.remove("grabbing")),this._renderer.render(this.scene,this.camera)},Viewport.prototype._getRaycastObject=function(){var _this=this;return this._raycastObjectCache?this._raycastObjectCache:(this.objectGroup.traverse(function(child){child instanceof THREE.Mesh&&(_this._raycastObjectCache=child)}),this._raycastObjectCache)},Viewport.prototype._getWidth=function(){return this._isFullscreen?window.innerWidth:this._element.offsetWidth},Viewport.prototype._getHeight=function(){return this._isFullscreen?window.innerHeight:this._element.offsetHeight},Viewport.prototype._getZoomSpeed=function(){return this._getBoundingWidth()*this.options.data.zoomSpeed},Viewport.prototype._getMaxZoom=function(){return this._getBoundingWidth()*this.options.data.maxZoom},Viewport.prototype._getMinZoom=function(){return this._getBoundingWidth()*this.options.data.minZoom},Viewport.prototype.zoomIn=function(){var targetZoom=this.camera.position.z-this._getZoomSpeed();targetZoom>this._getMinZoom()?this._targetZoom=targetZoom:this._targetZoom=this._getMinZoom()},Viewport.prototype.zoomOut=function(){var targetZoom=this.camera.position.z+this._getZoomSpeed();targetZoom<this._getMaxZoom()?this._targetZoom=targetZoom:this._targetZoom=this._getMaxZoom()},Viewport.prototype.enterVR=function(){this._isVRMode=!0,this._prevCameraPosition=this.camera.position.clone(),this._prevCameraRotation=this.camera.rotation.clone(),this._createRenderer()},Viewport.prototype.exitVR=function(){this._isVRMode=!1,this.camera.position.copy(this._prevCameraPosition),this.camera.rotation.copy(this._prevCameraRotation),this._createRenderer()},Viewport.prototype.toggleVR=function(){this._isVRMode?this.exitVR():this.enterVR()},Viewport.prototype.enterFullscreen=function(){if(this.options.data.fullscreenEnabled){var elem=this._element,requestFullScreen=this._getRequestFullScreen(elem);requestFullScreen&&requestFullScreen.call(elem)}},Viewport.prototype.exitFullscreen=function(){var exitFullScreen=this._getExitFullScreen();exitFullScreen&&exitFullScreen.call(document)},Viewport.prototype._getRequestFullScreen=function(elem){return elem.requestFullscreen?elem.requestFullscreen:elem.msRequestFullscreen?elem.msRequestFullscreen:elem.mozRequestFullScreen?elem.mozRequestFullScreen:!!elem.webkitRequestFullscreen&&elem.webkitRequestFullscreen},Viewport.prototype._getExitFullScreen=function(){return document.exitFullscreen?document.exitFullscreen:document.msExitFullscreen?document.msExitFullscreen:document.mozCancelFullScreen?document.mozCancelFullScreen:!!document.webkitExitFullscreen&&document.webkitExitFullscreen},Viewport.prototype._getAspectRatio=function(){return this._isVRMode?window.innerWidth/window.innerHeight:this._viewport.offsetWidth/this._viewport.offsetHeight},Viewport.prototype.on=function(name,callback,ctx){var e=this._e||(this._e={});(e[name]||(e[name]=[])).push({fn:callback,ctx:ctx})},Viewport.prototype.fire=function(name){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];var data=[].slice.call(args,1),evtArr=((this._e||(this._e={}))[name]||[]).slice(),i=0,len=evtArr.length;for(i;i<len;i++)evtArr[i].fn.apply(evtArr[i].ctx,data)},Viewport.prototype.resize=function(){this._resize()},Viewport.prototype._resize=function(){if(this._element&&this._viewport){var width=String(this._getWidth()+"px"),height=String(this._getHeight()+"px");this._element.style.width=width,this._element.style.height=height,this._viewport.style.width=width,this._viewport.style.height=height,this._viewportCenter.x=this._viewport.offsetWidth/2,this._viewportCenter.y=this._viewport.offsetHeight/2,this.camera.aspect=this._getAspectRatio(),this.camera.updateProjectionMatrix(),this._renderer.setSize(this._viewport.offsetWidth,this._viewport.offsetHeight),this._loading.style.left=String(this._viewportCenter.x-this._loading.offsetWidth/2)+"px",this._loading.style.top=String(this._viewportCenter.y-this._loading.offsetHeight/2)+"px"}else this._oldie&&(this._oldie.style.left=String(this._element.offsetWidth/2-this._oldie.offsetWidth/2)+"px",this._oldie.style.top=String(this._element.offsetHeight/2-this._oldie.offsetHeight/2)+"px")},Viewport}();Virtex.Viewport=Viewport;var Events=function(){function Events(){}return Events.LOADED="loaded",Events}();Virtex.Events=Events}(Virtex||(Virtex={})),function(g){g.Virtex||(g.Virtex=Virtex)}(global)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});